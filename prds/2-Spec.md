# Theia-Based FDC3 Workspace Platform

## Spec

**Product Vision:** The proposed platform is a **browser-based and Electron-based workspace container** that allows users to run multiple business applications (as pluggable “apps” - implemented as Theia extensions and packaged as VSIX files) side by side, share context between them, and organize their workflow by **workspaces**. It draws inspiration from OpenFin/HERE Enterprise Browser, but is built on open-source technology (Theia IDE). The goal is to provide the interoperability and unified experience of a financial desktop container while leveraging the rich ecosystem of VS Code extensions for app development.

**What is Being Built:** The **Theia FDC3** platform is an open-source desktop container that enables multiple financial applications to run in an integrated workspace and communicate via the FDC3 interoperability standard. In essence, it is an FDC3 **“Desktop Agent”** built on Eclipse Theia. The platform will allow users (e.g. traders, analysts, developers) to launch a suite of web apps within a unified workbench and have those apps share data context and execute cross-app workflows (intents) seamlessly. Unlike a traditional IDE, this platform is geared toward financial apps (charts, blotters, trading tools, etc.) rather than code editors – however, it leverages Theia’s IDE framework for window management, extensions, and its new AI capabilities.

### Key Use Cases and Features

- **Multiple Contextual Workspaces:** Users can create and manage multiple workspaces, each tied to a distinct context (for example, a specific client or project). Within a workspace, any context-changing action (like selecting a client) will broadcast to all apps in that workspace only, keeping other workspaces independent. Workspaces are presented as top-level tabs within the application (not separate browser tabs or windows), allowing quick switching. This enables a user to handle different clients or tasks in parallel without context collisions. _Why:_ In financial or enterprise workflows, users often juggle multiple clients/cases – separating them prevents confusion and fosters focus.
- **Flexible App Layouts:** Within each workspace, the user can arrange app windows (panels) flexibly in the central area. They can tile apps side-by-side, stack them in tabs, or split the view using Theia’s docking layout controls. There will be dedicated regions: an app launcher on the far left, a left sidebar for context/navigation apps (e.g. a client selector panel, a list of workspaces), a main content area for core apps, a right sidebar for the AI assistant and notifications center, and a bottom bar for logs and similar output. The layout should be persistent per workspace (with ability to save and restore layouts automatically when reopening a context). _Why:_ Users need to see multiple information sources simultaneously (e.g., client info app next to analytics app). Providing a flexible layout boosts productivity and mirrors familiar IDE or container layouts. We leverage Theia’s existing split-panel capabilities to implement this.
- **Context Sharing and FDC3 Interop:** The platform will include a global **DesktopAgent** to manage inter-app communication via the FDC3 standard. Apps can broadcast data (contexts) or raise intents (requests for action) that other apps in the same workspace can listen for and handle. For example, if an app broadcasting a `ClientContext` is active and the user selects a client “ACME Corp”, other apps in that workspace listening for `ClientContext` updates will receive that data and update themselves accordingly. If an app raises an intent like `ViewChart` for a particular stock, another app in the workspace can handle it (if it registered an intent listener for `ViewChart`). We will utilize Theia’s internal messaging mechanisms to route these events under the hood, but from the app developer’s perspective, they simply use the FDC3 API (`fdc3.broadcast`, `fdc3.raiseIntent`, etc.). The DesktopAgent ensures scope: context broadcasts or intents are delivered only to apps within the active workspace context (preventing bleed-over to other workspace tabs). _Why:_ This capability is analogous to OpenFin’s Interop and is core to a unified platform – it eliminates copy-paste and manual synchronization by linking apps together through shared context: [here.io](https://www.here.io/here-core#:~:text=Interop%20and%20FDC3%20APIs). Adopting the FDC3 standard means our container can integrate with any other FDC3-compliant apps or services in the future, reducing vendor lock-in for our users.
- **App Launching and Discovery (App Store):** Users can discover, install, and launch new apps through an integrated App Store interface. This will be based on the Open VSX extension registry. The platform will connect to a **self-hosted Open VSX registry** (an open-source marketplace for VS Code extensions) to fetch a list of available apps (VSIX packages): [theia-ide.org](https://theia-ide.org/docs/blueprint_documentation/#:~:text=Extension%20sources). Within the UI, a familiar Extensions view (rebranded as “App Store”) will allow searching or browsing apps by category. Installation of an app will make it immediately available in the platform. Launching apps: after installation, an app can be launched into the current workspace (for example, by clicking “Open” or via a dock menu if provided). We will repurpose the existing Theia/VS Code "Activity bar" as a Dock or App Launcher toolbar – a shortcut bar where frequently used apps or user-chosen apps can be pinned for one-click launching, similar to a taskbar. _Why:_ A built-in app store lowers the barrier to extending the platform and allows non-technical users to add capabilities easily. Using the VSIX format means developers can package apps in a known format and even reuse many VS Code extensions. A quick launcher (dock) improves UX by not requiring users to navigate menus to open apps they use often.
- **Notifications Center:** Applications within the workspace can raise notifications through the platform. We will use Theia’s notification UI (which typically shows a toast or message prompt) to display these. Notifications can include rich content and interactive elements (e.g., buttons). For example, a trading alert app might raise a notification “Price threshold reached for STOCK ABC” with options to “View Details” or “Snooze”. The platform will route notification click events back to the originating app or a designated handler via the FDC3 intent mechanism or direct callback. We will implement a **notification history view** (similar to the VS Code notification center or OpenFin’s Notification Center: [here.io](https://www.here.io/here-core#:~:text=Notification%20Center)) where users can see past notifications, group or filter them. This will need to have a toggle for all notifications, and just ones relevent to the current workspace.. _Why:_ Notifications are crucial in a multi-app environment to alert users of important events without requiring every app to be visible at all times. By centralizing them, we ensure users don’t miss critical updates. Using Theia’s existing mechanisms lets us implement this feature quickly and consistently.
- **Integrated AI Assistant Panel:** On the right sidebar of each workspace, users will have access to an AI chat assistant. We plan to leverage Theia’s built-in AI capabilities (Theia recently introduced an AI assistant integration: [theia-ide.org](https://theia-ide.org/docs/user_install_vscode_extensions/#:~:text=,12)) and adapt them to our context. This “AI Chat” panel can answer user queries, help with tasks like finding information across apps (akin to a super search), or even serve as a chatbot that interacts with the user’s current context. For instance, if the current workspace context is a client, the AI could be prompted with that context to answer questions specific to that client’s data (if such data is accessible). Initially, this AI assistant might rely on generic capabilities (like CodeGPT or an OpenAI integration included in Theia), but we will integrate it such that it’s easily accessible (opened by default in the right pane) and context-aware in the future. _Why:_ Many modern platforms include AI features to boost productivity. In our use case, an AI assistant can help summarize information from multiple apps or perform actions via intents upon user request, acting as a smart helper. Including it from the start (even if basic) sets the stage for advanced capabilities later (like natural language commands to navigate the workspace).
- **Logging and Debugging Tools:** To aid developers (and advanced users) in understanding the inter-app communication, the platform will include a logging view for FDC3 events and other app communications. We will repurpose or extend the existing Theia Output or Console panel to create an “Interop Log”. This log will record context broadcasts, intent raises, and resolution results in real-time, scoped by workspace. For example, if an app broadcasts a client context, an entry like “\[Workspace Alpha\] Broadcast ClientContext { clientId: 123 } by App X” would appear. Similarly, intents and their target resolution (which app handled it) would be logged. We may allow filtering this log by app or message type. _Why:_ In a complex app ecosystem, debugging who sent what context or why an intent didn’t trigger can be difficult. A built-in log viewer helps developers building apps on the platform to troubleshoot integration issues. It can also help with auditing and support, giving insight into the dynamic behavior of the workspace.

#### Example Use Cases

- _Context Sharing:_ A user opens a **Pricing** app and a **Trade Blotter** app. When they select an instrument (e.g. a stock symbol) in the Pricing app, that context is broadcast and the Trade Blotter app automatically filters to trades for that instrument. The user did not manually wire the apps together – the platform’s FDC3 context system handles it.
- _Intent Workflow:_ From a research News app, the user invokes a “Chart” intent on a specific company context. The platform finds an app capable of handling the "ViewChart" intent and either opens it or brings it into focus with the given context (e.g. a Charting app showing that company’s stock price)[github.com](https://github.com/finos/FDC3-Sail#:~:text=,workspace%20tabs). If multiple apps can handle the intent, the user is prompted to choose – enabling on-the-fly workflow compositions.
- _Workspace Management:_ The user can organize apps into **workspaces** or layouts. For example, a “Morning Dashboard” workspace tab could contain several apps (news, market data, portfolio) arranged tiled on the screen. The user can switch to another workspace tab (say “Trading”) with a different set of apps and layout. The platform remembers these arrangements, allowing quick context switching during the day.
- _App Discovery:_ A user wants to use a tool they haven’t opened yet. They open the “App Store” panel (app directory browser) within the platform, search or browse for the app by name or by capability (intents it can handle), then click to launch it. The app downloads or opens in a new view without the user having to manually navigate to a URL or install anything – the platform handles it based on the app’s directory manifest.
- _AI Assistance:_ A user can ask an integrated **AI assistant** questions or commands like “Show me the current price of IBM and open a chart for it” in a chat interface. The AI, leveraging the context of connected apps and possibly financial data sources, could respond with the price and, if integrated well, trigger the appropriate app (via an intent) to display the chart.

#### Features: (what and _why_, not how)

- **Workspace UI & Window Management:** A **workbench interface** that can host multiple web application views (as tabs, panels, or iframes) concurrently[github.com](https://github.com/finos/FDC3-Sail#:~:text=,workspace%20tabs). It provides typical window operations – opening, closing, resizing, tiling, and tabbing of app views – using Theia’s existing docking layout[theia-ide.org](https://theia-ide.org/docs/project_goals/#:~:text=Basic%20Workbench%20Frame). Users can create multiple named workspaces or tabs to group sets of apps, enabling context separation (e.g. different tasks or desks). The UI will include a sidebar or launcher for opening apps, a status bar for notifications or channel indicators, and possibly a top menu for global actions. This feature addresses the need for a unified environment (instead of many separate browser windows) and allows efficient multitasking with context linking.
- **FDC3 Desktop Agent (Interapp Bus) Integration:** At the heart, the platform implements the FDC3 **DesktopAgent API** so that embedded apps can use `fdc3` calls to communicate. This includes:
  - _Context Broadcasting and Listening:_ Apps can broadcast context data (like a selected customer or instrument), and other apps listening on the same **channel** will receive that data[github.com](https://github.com/finos/FDC3-Sail#:~:text=,workspace%20tabs). The platform manages a set of **channels** (including the standard user channels and app-specific private channels) so that apps can join a shared context or isolate their communications. Channel linking ensures that, for example, all apps on “Blue” channel update together when any one broadcasts new context. For POC purposes, channels will be equivalent to workspaces (i.e., each workspace tab has its own channel), but we may extend this later to allow multiple channels per workspace. This feature enables dynamic data sharing between apps without hardcoded integrations, fostering interoperability.
  - _Intents and Resolution:_ Apps can raise **intents** (pre-defined actions, e.g. “ViewChart”, “CreateOrder”) with an associated context. The Desktop Agent will look up which application(s) can handle that intent (based on the App Directory metadata)[fdc3.finos.org](https://fdc3.finos.org/docs/app-directory/overview#:~:text=). If exactly one handler is available, it will automatically launch or direct the intent to that app; if multiple are available, the user is prompted with an **Intent Resolver UI** to select their preferred app to handle the action. After resolution, the target app is brought into focus and given the context object to act upon. This feature provides workflow integration without apps needing direct knowledge of each other – fulfilling the “invoke another app to do X” promise of FDC3.
  - _App Management:_ The platform handles launching apps via `fdc3.open` calls or when the user selects an app from the UI. It ensures a single instance per app (or multiple if allowed) and keeps track of running app instances (so if an app is already open, `open` can bring it to front instead of duplicating). Apps can also be programmatically closed or reloaded through the agent. The agent also exposes metadata like `getInfo()` to provide its version/identity to apps and possibly custom extensions (for debugging or capability negotiation).
  - _FDC3 Event Routing:_ The Desktop Agent will orchestrate all FDC3 events – context broadcasts, intent requests, channel joins, etc. – and ensure they are delivered to the appropriate app listeners. This includes maintaining _private channels_ for directed context sharing between specific apps when needed (e.g. for results of an intent with a private conversation channel). Essentially, the platform’s interapp bus will offer the **full range of FDC3 2.x API functionality** so that any FDC3-compatible app can run without code changes.
- **Integrated App Directory (“App Store”)**: The platform will (in future) integrate with an FDC3 Application Directory to provide a catalog of available apps that the user can launch. The App Directory is a repository of app manifests/metadata including each app’s name, description, icon, URL, and what intents and context types it supports[fdc3.finos.org](https://fdc3.finos.org/docs/app-directory/overview#:~:text=An%20application%20directory%20,about%20apps%20in%20your%20ecosystem)[fdc3.finos.org](https://fdc3.finos.org/docs/app-directory/overview#:~:text=). By connecting to a standard App Directory (or using a bundled static directory for demo/training apps), the platform can present an in-app **App Store UI** – likely a panel with search, categories, and icons – so users can discover apps to add to their workspace. This feature is critical because **if an app is not listed in the directory, the Desktop Agent cannot reliably include it in intent resolution or context sharing workflows**[fdc3.finos.org](https://fdc3.finos.org/docs/app-directory/overview#:~:text=All%20this%20information%20is%20readily,use%20it%20to%20resolve%20intents). Using the directory also enables the intent resolver logic – the agent queries which apps can handle a given intent via their manifest. The directory integration may support remote fetching (from a URL endpoint following the FDC3 AppD API spec) and local caching. The platform will ship with a default set of example apps listed (for demo/training purposes) and allow configuration of one or more directory endpoints for a real deployment. Ultimately, the “app store” provides a smooth mechanism to onboard and manage the apps available in the ecosystem, and ensures the platform remains **agent-agnostic** (any FDC3-compliant app listing will work)[fdc3.finos.org](https://fdc3.finos.org/docs/app-directory/overview#:~:text=%23%20Agent).
- **Notifications System**: The platform will include a user notification mechanism to surface important messages or alerts from either the system or apps. This will leverage Theia’s `MessageService` to show unobtrusive toast notifications at the bottom of the screen[theia-ide.org](https://theia-ide.org/docs/message_service/#:~:text=By%20default%2C%20Theia%20will%20display,MessageClient). The platform will also include a Notifications Center that will show a list of notifications, allowing them to be managed in a cohesive manner. **Use cases for notifications** include: an app raises an intent that had no available handler (the user is notified no app could perform the requested action), an error occurs in an app (e.g. failure to load data, which the app’s code flags via the FDC3 bus or custom event – the platform can catch it and notify the user), or system events like “New app installed” or “Update available”. Notifications will have different levels (info, warning, error) with corresponding styling[theia-ide.org](https://theia-ide.org/docs/message_service/#:~:text=By%20default%2C%20Theia%20will%20display,MessageClient). Wherever possible, notifications will include actions – e.g., a notification that an intent has multiple handlers might let the user click to open the resolver UI, or an alert might have a “Open Log” action to see details. This feature ensures users are kept informed about background processes and errors, improving transparency and usability.
- **Logging & Monitoring**: To aid both developers and advanced users, the platform will provide logging of internal events and inter-app messages. A **Log View** or console panel will be available, listing significant events such as app launches/closures, contexts broadcast/received, intents raised/resolved, errors, and warnings. The log will include timestamps and structured details (e.g. “App X broadcast context Y on channel Z”). This is important for debugging complex workflows and verifying that apps are communicating as expected. The logging component will leverage Theia’s built-in output channels.
- **AI Assistant Integration**: A novel feature of this platform is an **AI-powered assistant** embedded into the workspace. Using **Theia AI** capabilities, we will provide an AI chat interface (for example, a panel titled “Assistant” or a chatbot icon in the toolbar) that users can interact with in natural language. The purpose is to enhance productivity and support: users might ask the assistant questions about using the platform (“How do I connect to the app store?”), about the data/apps (“Summarize today’s alerts” or “Find arbitrage opportunities between these two apps' data”), or even to automate multi-step workflows. The assistant will be built on the Theia AI framework which offers out-of-the-box integration with Large Language Models (LLMs) and tools to create custom AI **agents**[eclipsesource.com](https://eclipsesource.com/blogs/2024/10/07/introducing-theia-ai/#:~:text=1,JSON%20following%20a%20specific)[eclipsesource.com](https://eclipsesource.com/blogs/2024/10/07/introducing-theia-ai/#:~:text=2,your%20use%20cases%2C%20embed%20them). For our platform, we will develop a custom agent (or a set of agents) focused on financial desktop tasks – for example, an agent that can retrieve context from open apps, or execute FDC3 intents based on user requests. The AI assistant will emphasize **transparency and control**: users can configure the underlying model (choose between cloud AI like OpenAI or a local model) and the assistant will clarify when it is accessing data or performing an action (no “silent” app launches without user confirmation). By leveraging Theia’s AI extension points, the assistant’s UI will be a chat-style view that can display rich content (text, markdown, even charts if generated) and present buttons for suggested actions[eclipsesource.com](https://eclipsesource.com/blogs/2024/10/07/introducing-theia-ai/#:~:text=5,widgets%2C%20may%20it%20be%20textual). This feature is forward-looking – it not only provides immediate help (like a smart user guide) but could eventually handle complex queries, effectively becoming a **copilot** for financial analysis on the desktop (e.g. “what’s the risk exposure of my portfolio?,” which might involve collating data from multiple apps). The AI assistant is an optional but powerful addition to differentiate our platform as “AI-native” (in line with Theia’s vision of AI-enhanced tools[theia-ide.org](https://theia-ide.org/#:~:text=AI)).

### Assumptions and Constraints

- **Initial Scope vs Future Enhancements:** Some features will **not** be part of the initial release but are noted for future consideration. For example, advanced **App Directory** functionality (a centralized directory of all available apps with their metadata and intent support) is something FDC3 supports: [fdc3.finos.org](https://fdc3.finos.org/docs/api/ref/DesktopAgent#:~:text=A%20Desktop%20Agent%20can%20be,and%20implementation%20requirements%20are%20proprietary), but initially we may rely on the Open VSX registry and simple metadata. Another future item is **FDC3 Desktop Agent bridging** (connecting our DesktopAgent with other containers on the same desktop) – not in scope now. Also, true multi-window support (e.g., dragging an app out into a separate native window or multi-monitor support) is deferred; initially all apps live inside the single container window with tabs. We want to validate the core concept in one window first. These decisions keep the project focused, but we are mindful that enterprise users might request them later.
- **No Traditional IDE Functions:** Since our platform repurposes Theia from a coding IDE to a business app container, we assume features like text editing, a file explorer, or debugger are **out of scope**. We will strip out or disable these by default. We will keep the integrated terminal, AI Chat View, and "Extensions" panel though. The user is not expected to edit source code or manage a file system in this product. Instead, the left sidebar will host domain-specific navigation (like client lists or menus provided by apps), not a tree of files. This assumption simplifies the UI and avoids user confusion. (One caveat: we might retain _some_ generic utilities like a browser-like Developer Tools access for troubleshooting webview apps, but only for developers mode.)
- **Platform Compatibility:** The product must run on both modern web browsers and as an installed desktop application (Electron-based) on Windows (and ideally Mac/Linux for completeness). We assume the environment will have at least Chrome/Chromium engine (Electron uses Chromium, and for browser we’ll target Chrome/Edge for best support). Theia’s web-first design means almost everything is web tech, which we embrace. We also assume moderate hardware capabilities on user machines (Theia and Electron are not extremely lightweight, but acceptable for enterprise desktops).
- **Security Considerations:** We assume apps are generally trusted within the enterprise (since they will be installed via our controlled app store). However, we will still sandbox web content delivered via URL using iframes. Fully trusted apps can be embedded directly as widgets without requiring sandboxing. The VS Code webview API already provides an isolated iframe for extensions’ web content with only allowed messaging back to extension code. We will enforce content security policies to prevent malicious behavior. Also, since the platform may handle sensitive financial data, we will ensure that context data broadcasting is kept in-memory and not logged or sent externally (unless an extension does so on its own). Any future multi-tenant or cloud features will need authentication and encryption, but for now we assume a single-user local environment without login (the user is already authenticated to their machine or network).
- **Performance Constraints:** Running multiple apps inside one container means performance needs attention. We expect users might have 5-10 apps open per workspace, and maybe a couple of workspaces active. Theia’s architecture runs all VS Code extensions in a separate process (the plugin host) and heavy-lifting on a backend process. We assume this will handle our use case, but we will monitor memory and CPU usage. If needed, we might put certain apps to sleep when not in use or unload entire workspaces from memory if a user hasn’t looked at one in a while (as a future optimization). For now, performance should be acceptable given typical VS Code can handle many extensions simultaneously.
- **Unknowns / Open Questions:** Throughout development, a few questions need clarification:

  - _FDC3 Version_: We assume FDC3 2.0+ (latest 2.2) for DesktopAgent API. This gives us the channels concept which we can use for workspace scoping. We should confirm if any backward compatibility with FDC3 1.2 is needed.
    **Answer:** We will only support FDC3 2.0+.
  - _Context Data Models_: What context types and intent names will our target apps use? We might define custom context types (e.g., `ClientContext` with clientId, name, etc.) for our domain. This requires coordination with app developers or an app directory schema later. **Answer:** We will be using custom context and intents at a later date, but initially, only standard FDC3 ones are required to be supported.
  - _App Directory Integration_: In the future, do we plan to integrate a formal FDC3 App Directory service for app discovery and metadata (beyond the Open VSX registry)? This could enhance features like `findIntent` by looking up which app can handle an intent. For now, we’ll implement a simple in-memory directory or use a manifest in each extension.
    **Answer:** For now, we’ll use a manifest in each extension.
  - _App Launcher UI_: We propose a dock for launching installed apps; we should confirm if this is desired in MVP or if using Theia’s Command Palette / menu is sufficient initially. A slick app launcher will improve UX but could be added later.
    **Answer:** We will repurpose the existing Theia/VS Code "Activity bar" as a Dock or App Launcher toolbar
  - _Layout Persistence_: Should we implement saving and restoring of workspace layouts (positions and open apps) across sessions? We assume yes for user convenience, but it adds complexity (especially since we aren’t using file-workspaces to auto-save state). Possibly we store layout in local storage or a settings file keyed by workspace context. This needs confirmation.
    **Answer:** Yes, just persist to local storage initially.
  - _Branding and Naming_: We refer to the product as “Theia FDC3 Platform” here, but a proper product name and branding (icons, logos) will be needed. This is a minor point but part of polish – presumably will be decided later in the project. **Answer:** Just refer to it as "Theia FDC3" for now.

#### Assumptions

- Target applications are web-based (HTML/JavaScript) apps that either natively use the FDC3 API or can be adapted to use it. We assume these apps are loaded either from a URL or served via the platform as "widgets" and are built to be **FDC3-compliant** (they will call `fdc3.raiseIntent`, etc., rather than some other interop mechanism). Non-FDC3 apps could still be loaded in iframes, but they won’t benefit from interop features unless updated to use the standard.
- Users have access to at least one FDC3 App Directory service (or a static JSON manifest) that lists the apps they intend to use. The quality of app metadata (correct intents, context declarations) is assumed to be good, as it drives the platform’s ability to resolve workflows. We also assume apps are trusted/approved and the App Directory is curated to some degree (the platform will not be responsible for deeply sandboxing malicious code beyond what a browser provides).
- The platform will use the **FDC3 2.0+** APIs (latest version available, e.g. 2.1 or 2.2) as the baseline. This implies the presence of the Web API (`fdc3.getAgent()` mechanism) for connecting apps in regular browsers[fdc3.finos.org](https://fdc3.finos.org/docs/next/api/supported-platforms#:~:text=Web)[fdc3.finos.org](https://fdc3.finos.org/docs/next/api/supported-platforms#:~:text=,Agent%20API%20is%20used%20to), as well as support for legacy `window.fdc3` injection in Electron. We assume browsers running the platform will be modern and support postMessage, etc., as required by FDC3’s Web Connection specification.
- Performance considerations: We assume a typical user might run 5-10 apps concurrently in the workspace. Theia’s web technology stack and Electron should handle this, but we assume apps are reasonably lightweight (front-end heavy apps like trading blotters with hundreds of DOM elements are expected; the platform should manage, given Theia can handle multiple code editors, which is similar magnitude). We also assume the backend (if remote) has sufficient resources to serve the apps and handle messaging.
- The development team will have proficiency in TypeScript/React and familiarity with Theia’s extension system. We also assume support from the FDC3 community for clarifying standard behavior if needed (since FDC3 can be complex). For AI integration, we assume access to at least one LLM (via API key for OpenAI or a local model) and that using such a model is permitted in the deployment environment (financial firms may restrict external AI access, in which case a local model might be used).

#### Constraints:

- **Security sandboxing**: Since apps might come from different sources (domains), we must abide by browser security. For web deployment, apps likely run in iframes in different origins. The FDC3 **Desktop Agent Proxy** approach (postMessage between frames) will be used to bridge context, constrained by the same-origin policy and the standardized **DACP** (Desktop Agent Communication Protocol)[fdc3.finos.org](https://fdc3.finos.org/docs/next/api/supported-platforms#:~:text=,Agent%20API%20is%20used%20to)[fdc3.finos.org](https://fdc3.finos.org/docs/next/api/supported-platforms#:~:text=The%20FDC3%20Standard%20defines%20a,in%20a%20web%20browser). In Electron, a preload script will inject the FDC3 API, but even then we’ll ensure an app’s access is sandboxed (no direct Node.js access unless explicitly allowed). We must design within these security constraints, meaning careful use of window messaging, not exposing global objects beyond FDC3, and validating message origins.
- **Theia Framework Constraints**: We are building on Theia, so we will fit within its extension model and UI paradigms. We might be constrained by Theia’s update cycle – for example, changes to core Theia or Theia AI might necessitate version bumps in our product. Also, Theia has its own default features (like file explorer, text editor) which we may disable or remove for this product to avoid confusion. We need to ensure our custom UI elements (app launcher, etc.) integrate smoothly with Theia’s layout and theming.
- **App Directory Availability**: The platform’s usefulness depends on an up-to-date App Directory. In scenarios where the platform is used offline or on an intranet, a local or cached directory must be available. If no directory is reachable, the platform can only work with pre-packaged apps (limiting dynamic discovery). We will thus include a fallback (perhaps a bundled JSON of core apps) but note that dynamic app search might be constrained by network access.
- **AI Usage**: The AI assistant’s capabilities depend on the chosen models and the data it can access. Company policy or data privacy rules might constrain which data can be fed into an AI model. We will constrain the assistant such that it only has access to user-visible information (e.g., context that apps broadcast or what the user explicitly shares to it). The AI feature will be architecturally isolated so that if needed, it can be disabled entirely without breaking core interoperability features (some deployments may choose to turn off AI due to compliance). Performance is also a factor: AI queries to a cloud service can be slow or costly; we must handle that by using asynchronous calls and showing progress to the user.
- **Timeline & Phases**: Given the breadth of features, it’s expected that not everything will be delivered at once. We will prioritize core FDC3 support and basic UI first, with advanced features (AI assistant, possibly multi-workspace saving, etc.) coming in later phases. The specification acknowledges that some “nice-to-have” aspects (like extremely fine-grained logging or a very advanced AI workflow integration) might be scoped down if time/resources constrain, but the architecture will leave hooks to add them later.

In summary, the Theia FDC3 Platform is **building a full-featured, standard-compliant financial desktop container**. It focuses on _what_ users and apps need: a common workspace to run apps side by side, a communication bus for interoperability (contexts/intents), a discovery mechanism for available apps, feedback via notifications and logs, and modern enhancements like an AI helper. All of this is done on top of Theia to leverage its strength in modular tool development and to allow running either as a desktop app or purely in the cloud. This specification avoids detailing how to code each feature (that comes in the Plan), but it clarifies the scope and purpose of each major component in the final product.
